/*! indexedDBmock 10-03-2015 */
!function(a){var b=1,c={},d={open:function(a,d){var j,k={};for(var l in c)l===a&&(j=c[l]);j||(d||(d=1),j=new f(a),c[a]=j);var m=new g(j);return d&&m.version>d?setTimeout(function(){"function"==typeof k.onerror&&(k.target=k,k.target.errorCode="VersionError",k.target.error={name:"VersionError"},k.target.readyState="done",k.onerror(k))},b):d&&m.version<d?setTimeout(function(){k.target=k,k.target.readyState="done",k.target.type="upgradeneeded",k.target.newVersion=d,k.target.oldVersion=m.version,k.target.transaction=new i(null,e.VERSIONCHANGE,new h(j,m)),k.target.transaction.db.version=d,m.version=d,j.version=d,"function"==typeof k.onupgradeneeded&&(k.onupgradeneeded(k),j.objectStores=k.target.transaction.db._objectStores,j.objectStoreNames=k.target.transaction.db.objectStoreNames),setTimeout(function(){k.target.transaction._aborted?"function"==typeof k.onerror&&(k.target=k,k.target.errorCode=8,k.target.error={name:"AbortError",message:"The transaction was aborted."},k.target.readyState="done",k.onerror(k)):"function"==typeof k.onsuccess&&(k.target=k,k.target.result=m,k.target.readyState="done",j.connections.push(m),k.onsuccess(k));for(var a=0;a<j.connections.length;a++)j.connections[a]._connectionId!==m._connectionId&&"function"==typeof j.connections[a].onversionchange&&(j.connections[a].target=j.connections[a],j.connections[a].target.readyState="done",j.connections[a].target.type=e.VERSIONCHANGE,j.connections[a].target.version=d,j.connections[a].onversionchange(j.connections[a]))},b)},b):setTimeout(function(){"function"==typeof k.onsuccess&&(k.target=k,k.target.result=m,k.target.readyState="done",j.connections.push(m),k.onsuccess(k))},b),k},deleteDatabase:function(a){var d={};for(var e in c)e===a&&(c[e]=void 0,delete c[e]);return setTimeout(function(){"function"==typeof d.onsuccess&&(d.target=d,d.target.readyState="done",d.onsuccess(d))},b),d},cmp:function(){}},e={READONLY:"readonly",READWRITE:"readwrite",VERSIONCHANGE:"versionchange"},f=function(a){this.name=a,this.version=0,this.objectStoreNames=[],this.objectStores=[],this.connections=[],this.transactions=[]},g=function(a){this.name=a.name,this.version=a.version,this.objectStoreNames=a.objectStoreNames,this._connectionId=a.connections.length,this._db=a},h=function(a,b){this.name=a.name,this.version=a.version,this.objectStoreNames=a.objectStoreNames,this._db=a,this._connection=b,this._objectStores=a.objectStores||[]},i=function(a,b,c){if(b||(b=e.READONLY),b!==e.VERSIONCHANGE&&(!a||0===a.length))throw{name:"InvalidAccessError"};if(a)for(var d=0;d<a.length;d++){for(var f=!1,g=0;g<c.objectStoreNames.length;g++)c.objectStoreNames[g]===a[d]&&(f=!0);if(!f)throw{name:"NotFoundError"}}this.mode=b,this.db=c,this.objectStoreNames=a,this.db.transaction=this,this.__active=!0,this._aborted=!1},j=function(a,b,c){this.name=a,this.keyPath=b?b.keyPath:void 0,this.autoIncrement=b?b.autoIncrement:void 0,this.indexNames=[],this.transaction=c,this._indexes=[]},k=function(){},l=function(a,b,c,d){this.name=a,this.keyPath=b,this.multiEntry=c?c.multiEntry:void 0,this.unique=c?c.unique:void 0,this.objectStore=d};g.prototype=function(){function a(){for(var a=0;a<this._db.connections.length;a++)this._db.connections[a].connectionId===this._connectionId&&this._db.connections.splice(a,1)}function c(a,d){var e=new i(a,d,new h(this._db,this));return this._db.transactions.push(c),setTimeout(function(){"function"!=typeof e.oncomplete||e._aborted||(e.target=e,e.target.result=c,e.target.readyState="done",e.oncomplete(e))},b),e}return{close:a,transaction:c}}(),h.prototype=function(){function a(){this._connection.close()}function b(a,b){return this._connection.transaction(a,b)}function c(a,b){if(this.transaction.mode!==e.VERSIONCHANGE)throw{name:"InvalidStateError"};if(b&&b.keyPath instanceof Array)for(var c=0;c<b.keyPath.length;c++)if(""===b.keyPath[c])throw this.transaction.abort(),{name:"InvalidAccessError"};var d=new j(a,b,this.transaction);return this._objectStores.push(d),this.objectStoreNames.push(a),d}function d(a){if(this.transaction.mode!==e.VERSIONCHANGE)throw{name:"InvalidStateError"};for(var b=!1,c=0;c<this.objectStoreNames.length;c++)this.objectStoreNames[c]===a&&(this.objectStoreNames.splice(c,1),b=!0);if(!b)throw{name:"NotFoundError"};for(var d=0;d<this._objectStores.length;d++)this._objectStores[d].name===a&&this._objectStores.splice(d,1)}return{close:a,transaction:b,createObjectStore:c,deleteObjectStore:d}}(),i.prototype=function(){function a(){this._aborted=!0;var a=this;setTimeout(function(){"function"==typeof a.onabort&&(a.target=a,a.target.errorCode=8,a.target.error={name:"AbortError",message:"The transaction was aborted."},a.target.readyState="done",a.onabort(a))},b)}function c(a){if(this.mode!==e.VERSIONCHANGE){for(var b=!1,c=0;c<this.objectStoreNames.length;c++)this.objectStoreNames[c]===a&&(b=!0);if(!b)throw{name:"NotFoundError"}}for(var d=0;d<this.db._objectStores.length;d++)if(this.db._objectStores[d].name===a)return this.db._objectStores[d].transaction=this,this.db._objectStores[d];throw{name:"NotFoundError"}}return{abort:a,objectStore:c}}(),j.prototype=function(){function a(){}function b(a,b,c){if(this.transaction.mode!==e.VERSIONCHANGE)throw{name:"InvalidStateError"};if(b&&b instanceof Array)for(var d=0;d<b.length;d++)if(""===b[d])throw this.transaction.abort(),{name:"InvalidAccessError"};var f=new l(a,b,c,this);return this._indexes.push(f),this.indexNames.push(a),f}function c(a){if(this.transaction.mode!==e.VERSIONCHANGE)throw{name:"InvalidStateError"};for(var b=!1,c=0;c<this.indexNames.length;c++)this.indexNames[c]===a&&(this.indexNames.splice(c,1),b=!0);if(!b)throw{name:"NotFoundError"};for(var d=0;d<this._indexes.length;d++)this._indexes[d].name===a&&this._indexes.splice(d,1)}function d(a){if(this.mode!==e.VERSIONCHANGE){for(var b=!1,c=0;c<this.indexNames.length;c++)this.indexNames[c]===a&&(b=!0);if(!b)throw{name:"NotFoundError"}}for(var d=0;d<this._indexes.length;d++)if(this._indexes[d].name===a)return this._indexes[d].objectStore=this,this._indexes[d];throw{name:"NotFoundError"}}return{get:a,createIndex:b,deleteIndex:c,index:d}}(),l.prototype=function(){function a(){}return{get:a}}(),a.indexedDBmock=d,a.IDBCursormock=k,a.IDBDatabasemock=h,a.IDBTransactionmock=i,a.IDBObjectStoremock=j,a.IDBRequestmock=j,a.IDBIndexmock=l,a.indexedDBmockDbs=c}(window||self);